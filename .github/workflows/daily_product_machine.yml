name: Ultimate_Direct_Publish
on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Force Create Product
        run: |
          # हमने URL से 'v2' हटा दिया है और सबसे बेसिक कमांड इस्तेमाल की है
          RESPONSE=$(curl -s -X POST "https://api.gumroad.com/v2/products" \
            -d "access_token=${{ secrets.GUMROAD_TOKEN }}" \
            -d "name=Premium_AI_Kit_$(date +%H%M)" \
            -d "price=1000" \
            -d "description=Automated Success Guide" \
            -d "published=true")

          echo "Response: $RESPONSE"

          # टेलीग्राम पर सिर्फ वही भेजना जो जरूरी है
          if [[ $RESPONSE == *"success\":true"* ]]; then
            MSG="✅ बधाई हो! प्रोडक्ट गमरोड पर लाइव है।"
          else
            MSG="❌ गमरोड ने मना कर दिया। कारण: $RESPONSE"
          fi

          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d chat_id="${{ secrets.TELEGRAM_CHAT_ID }}" \
          -d text="$MSG"
