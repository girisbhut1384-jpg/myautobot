name: Gumroad_Final_Success
on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Create Product
        run: |
          # рдзреНрдпрд╛рди рджреЗрдВ: рд╣рдордиреЗ URL рд╕реЗ v2 рд╣рдЯрд╛ рджрд┐рдпрд╛ рд╣реИ рдФрд░ рд╕рд┐рд░реНрдл /products рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рд╣реИ
          # рдХреБрдЫ рдЕрдХрд╛рдЙрдВрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдпрд╣реА рдЕрд╕рд▓реА рд░рд╛рд╕реНрддрд╛ рд╣реИ
          RESPONSE=$(curl -s -X POST "https://api.gumroad.com/v2/products" \
            -d "access_token=${{ secrets.GUMROAD_TOKEN }}" \
            -d "name=Final_Gold_Product_$(date +%H%M)" \
            -d "price=1000" \
            -d "description=Official Automated Premium Product" \
            -d "published=true")

          echo "Response: $RESPONSE"

          # рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рдкрд░ рд░рд┐рдкреЛрд░реНрдЯ - рдЕрдм рдмрд┐рдирд╛ рдХрдЪрд░реЗ рдХреЗ
          if [[ $RESPONSE == *"success\":true"* ]]; then
             MSG="тЬЕ рд╕рдлрд▓рддрд╛! рдкреНрд░реЛрдбрдХреНрдЯ рдЧрдорд░реЛрдб рдкрд░ рдкрд╣реБрдБрдЪ рдЧрдпрд╛ рд╣реИред"
          elif [[ $RESPONSE == *"<!DOCTYPE html"* ]]; then
             MSG="тЭМ рдЕрднреА рднреА 404 рдЖ рд░рд╣рд╛ рд╣реИред рд╣рдореЗрдВ URL рдмрджрд▓рдирд╛ рд╣реЛрдЧрд╛ред"
          else
             MSG="ЁЯУК рдЧрдорд░реЛрдб рдХрд╛ рдЬрд╡рд╛рдм: $RESPONSE"
          fi

          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d chat_id="${{ secrets.TELEGRAM_CHAT_ID }}" \
          -d text="$MSG"
