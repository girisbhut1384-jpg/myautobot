name: 100_Percent_Success_Final
on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Create Product
        run: |
          # नया और सटीक पक्का रास्ता (बिना /v2/ के सीधे /products)
          RESPONSE=$(curl -s -X POST https://api.gumroad.com/v2/products/ \
            -H "Authorization: Bearer ${{ secrets.GUMROAD_TOKEN }}" \
            -H "Content-Type: application/json" \
            -d '{
              "name": "AI_Mastery_Final_Success",
              "price_cents": 1000,
              "description": "Premium Automated Product Guide",
              "published": true
            }')

          echo "Response: $RESPONSE"

          # टेलीग्राम पर साफ सुथरा मैसेज
          if [[ $RESPONSE == *"\"success\":true"* ]]; then
             MSG="✅ मुबारक हो! प्रोडक्ट अब Gumroad पर लाइव है।"
          else
             MSG="⚠️ मशीन चली पर Gumroad ने कुछ और कहा है: $RESPONSE"
          fi

          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d chat_id="${{ secrets.TELEGRAM_CHAT_ID }}" \
          -d text="$MSG"
